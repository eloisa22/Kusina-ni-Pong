<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kusina ni Daddy Pong</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Rubik:ital,wght@0,300..900;1,300..900&family=Tapestry&display=swap" rel="stylesheet">

    <style>
        body { 
            font-family: 'Rubik', sans-serif; 
            background: linear-gradient(black, white); 
            padding: 20px; /* Reduced padding for mobile friendliness */
            display: flex; 
            justify-content: center; 
            min-height: 100vh; 
            margin: 0; 
        }
        .container { background: white; width: 100%; max-width: 700px; border-radius: 15px; box-shadow: 0 2px 2px 5px #FFD150; overflow: hidden; height: fit-content; margin-top: 20px;}
        
        .header { background: #d63031; color: #FFD150; padding: 30px 20px; text-align: center; }
        .logo { width: 170px; height: auto; margin-bottom: 10px; border-radius: 50%; padding: 10px;  }
        
        .header h1 { 
            margin: 0; 
            font-family: "Tapestry", serif;
            font-size: 42px; 
            font-weight: 400;
        }

        .form { padding: 25px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; border-bottom: 2px solid #f0f2f5; }
        .full-width { grid-column: span 2; }
        
        label { font-size: 14px; font-weight: 700; color: #636e72; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 5px; display: block; }
        
        /* MADE INPUTS BIGGER HERE */
        input, select { 
            font-family: 'Rubik', sans-serif; 
            width: 100%; 
            padding: 16px; /* Increased padding */
            border: 2px solid #dfe6e9; 
            border-radius: 10px; 
            font-size: 20px; /* Increased font size */
            font-weight: 500;
            box-sizing: border-box; 
            color: #2d3436;
        }
        input:focus, select:focus { border-color: #d63031; outline: none; background-color: #fff9f9; }
        
        .btn-group { padding: 0 25px 25px; display: flex; gap: 15px; }
        button { 
            font-family: 'Rubik', sans-serif; 
            flex: 1; 
            padding: 18px; 
            border: none; 
            border-radius: 10px; 
            font-weight: 700; 
            cursor: pointer; 
            color: white; 
            transition: 0.2s; 
            text-transform: uppercase;
            font-size: 16px;
        }
        .btn-add { background: #d63031; box-shadow: 0 4px #b02626; }
        .btn-excel { background: #27ae60; box-shadow: 0 4px #1e8449; }
        button:active { transform: translateY(2px); box-shadow: 0 2px #881e1e; }

        .table-area { padding: 20px; max-height: 400px; overflow-y: auto; }
        table { width: 100%; border-collapse: collapse; }
        th { text-align: left; font-size: 13px; border-bottom: 2px solid #eee; padding: 12px; color: #b2bec3; font-weight: 700; text-transform: uppercase; }
        td { padding: 15px 12px; border-bottom: 1px solid #f1f2f6; font-size: 16px; color: #2d3436; }
        
        .total-section { 
            padding: 25px; 
            text-align: right; 
            background: #f9f9f9; 
            font-size: 26px; 
            font-weight: 900; 
            color: #d63031; 
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <img src="logo.png" alt="Daddy Pong Logo" class="logo">
        <h1>Kusina ni Daddy Pong</h1>
    </div>
    
    <div class="form">
        <div class="full-width">
            <label>Buyer's Name</label>
            <input type="text" id="buyerName" placeholder="Enter Full Name">
        </div>
        <div>
            <label>Product</label>
            <select id="prod">
                <option value="160">Chicken Pastil (Spicy) - ₱160</option>
                <option value="150">Chicken Pastil (Original) - ₱150</option>
                <option value="170">Kinamatisang Dilis - ₱170</option>
                <option value="180">Pork Binagoongan (S&S) - ₱180</option>
                <option value="180">Pork Binagoongan (Sweet) - ₱180</option>
                <option value="160">Chicken Roll (Ham) - ₱160</option>
                <option value="160">Chicken Roll (Hotdog) - ₱160</option>
                <option value="180">Pork Humba - ₱180</option>
            </select>
        </div>
        <div>
            <label>Quantity</label>
            <input type="number" id="qty" value="1" min="1">
        </div>
    </div>

    <div class="btn-group">
        <button class="btn-add" id="addBtn">ADD ENTRY</button>
        <button class="btn-excel" id="excelBtn">DOWNLOAD EXCEL</button>
    </div>

    <div class="table-area">
        <table id="orderTable">
            <thead>
                <tr><th>Name</th><th>Item</th><th>Qty</th><th>Total</th></tr>
            </thead>
            <tbody id="tbody"></tbody>
        </table>
    </div>
    <div class="total-section">
        Grand Total: ₱<span id="grandDisplay">0</span>
    </div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDA_Xr94im77KKizIz5IBB3FeGweCP1Egc",
    authDomain: "food-admin2.firebaseapp.com",
    databaseURL: "https://food-admin2-default-rtdb.firebaseio.com",
    projectId: "food-admin2",
    storageBucket: "food-admin2.firebasestorage.app",
    messagingSenderId: "1007400386429",
    appId: "1:1007400386429:web:2778b245d782f72ec3d614"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const ordersRef = ref(db, 'orders');

  const addBtn = document.getElementById('addBtn');
  const excelBtn = document.getElementById('excelBtn');

  addBtn.addEventListener('click', () => {
      const name = document.getElementById('buyerName').value || "Anonymous";
      const prodSelect = document.getElementById('prod');
      const itemName = prodSelect.options[prodSelect.selectedIndex].text.split(' - ')[0];
      const price = parseInt(prodSelect.value);
      const quantity = parseInt(document.getElementById('qty').value);
      
      const newOrder = {
          name: name,
          item: itemName,
          qty: quantity,
          total: price * quantity,
          timestamp: new Date().toLocaleString()
      };

      push(ordersRef, newOrder);
      document.getElementById('qty').value = 1; 
      document.getElementById('buyerName').value = ""; // Clears name after adding
  });

  onValue(ordersRef, (snapshot) => {
      const data = snapshot.val();
      const tbody = document.getElementById('tbody');
      let grandTotal = 0;
      tbody.innerHTML = "";

      if (data) {
          Object.values(data).reverse().forEach(order => {
              grandTotal += order.total;
              const row = `<tr>
                  <td>${order.name}</td>
                  <td><b>${order.item}</b></td>
                  <td>${order.qty}</td>
                  <td>₱${order.total.toLocaleString()}</td>
              </tr>`;
              tbody.innerHTML += row;
          });
      }
      document.getElementById('grandDisplay').innerText = grandTotal.toLocaleString();
  });

  excelBtn.addEventListener('click', () => {
      onValue(ordersRef, (snapshot) => {
          const data = snapshot.val();
          if(!data) return alert("No data yet!");

          let csv = "Date,Buyer Name,Product,Quantity,Total\n";
          Object.values(data).forEach(o => {
              csv += `"${o.timestamp}","${o.name}","${o.item}",${o.qty},${o.total}\n`;
          });

          const blob = new Blob([csv], { type: 'text/csv' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = "Kusina_Daddy_Pong_Sales.csv";
          a.click();
      }, { onlyOnce: true });
  });
</script>

</body>

</html>
